.app {
  display: flex;
  flex-direction: column;
  width: 100%;
  max-width: 100%;
  height: 100%;
  height: 100dvh;
  overflow: hidden;
  padding-left: var(--space-5);
  padding-right: 0;
  padding-bottom: max(var(--space-5), var(--safe-bottom));
  padding-top: var(--space-5);
  box-sizing: border-box;
}

.app__main {
  display: flex;
  flex-direction: row;
  flex: 1;
  min-height: 0;
  overflow: hidden;
}

/* ----- –õ–µ–≤–æ–µ –º–µ–Ω—é (LeftToggleMenu) ----- */
.app__left {
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  padding-right: var(--space-2);
  padding-top: var(--space-4);
  padding-left: 0;
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä: —Ç–µ–º–∞ + –≥—Ä–æ–º–∫–æ—Å—Ç—å –≤ –æ–¥–Ω—É –≥—Ä—É–ø–ø—É, –ø–æ —Ä–∞–∑–º–µ—Ä—É –≤–ø–æ–ª–æ–≤–∏–Ω—É –æ—Ç –∫–Ω–æ–ø–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞ */
.app__left-actions {
  margin-top: var(--space-4);
  padding-left: 0;
  display: flex;
  align-items: center;
  gap: var(--space-1);
}

/* –ö–Ω–æ–ø–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞: min-width 76px, padding space-6/5 ‚Üí –ø–æ–ª–æ–≤–∏–Ω–∞: ~38px, padding –º–µ–Ω—å—à–µ */
.app__left-actions .theme-toggle__button {
  min-width: 38px;
  width: 38px;
  height: 38px;
  padding: 0;
  border-radius: var(--radius);
  gap: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

.app__left-actions .theme-toggle__label,
.app__left-actions .theme-toggle__arrow {
  display: none;
}

/* –ù–∞ –∫–Ω–æ–ø–∫–µ —Ç–æ–ª—å–∫–æ –ª—É–Ω–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É, –∏–∫–æ–Ω–∫—É —Ç–µ–º—ã —É–±–∏—Ä–∞–µ–º */
.app__left-actions .theme-toggle__icon {
  font-size: 0;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  line-height: 1;
}

.app__left-actions .theme-toggle__icon::after {
  content: "üåô";
  font-size: var(--text-lg);
  display: block;
  line-height: 1;
}

.sound-toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 38px;
  height: 38px;
  padding: 0;
  border: none;
  border-radius: var(--radius);
  flex-shrink: 0;
  background: var(--glass-bg);
  color: var(--tg-theme-text-color);
  cursor: pointer;
  font-size: 1rem;
}

.sound-toggle:hover {
  opacity: 0.9;
}

.left-toggle-menu {
  display: flex;
  flex-direction: column;
}

.left-toggle-menu__triggers {
  display: flex;
  flex-direction: column;
  gap: var(--space-4);
}

.left-toggle-menu__btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-1);
  padding: var(--space-6) var(--space-5);
  min-width: 76px;
  border: none;
  border-radius: var(--radius);
  background: var(--glass-bg);
  backdrop-filter: blur(var(--blur-md));
  -webkit-backdrop-filter: blur(var(--blur-md));
  border: 1px solid var(--glass-border);
  color: var(--tg-theme-hint-color);
  font-size: var(--text-base);
  font-weight: var(--font-normal);
  cursor: pointer;
  transition: all var(--transition-base);
  box-shadow: var(--shadow-sm);
}

.left-toggle-menu__btn:hover,
.left-toggle-menu__btn:focus-visible {
  color: var(--tg-theme-text-color);
  transform: scale(var(--hover-scale));
  box-shadow: var(--shadow-md);
}

.left-toggle-menu__btn--active {
  background: var(--gradient-button);
  color: var(--tg-theme-button-text-color);
  box-shadow: var(--shadow-glow);
}

.left-toggle-menu__btn:active {
  transform: scale(var(--active-scale));
}

.left-toggle-menu__icon {
  font-size: var(--text-2xl);
  line-height: 1;
}

.left-toggle-menu__label {
  line-height: 1.1;
  text-align: center;
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Backdrop */
.left-toggle-menu__panel-backdrop {
  position: fixed;
  inset: 0;
  z-index: 49;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  animation: left-toggle-menu-fade-in var(--transition-base);
}

@keyframes left-toggle-menu-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* –í—ã–µ–∑–∂–∞—é—â–∞—è –ø–∞–Ω–µ–ª—å */
.left-toggle-menu__panel {
  position: fixed;
  left: 0;
  top: 0;
  bottom: 0;
  z-index: 50;
  width: min(320px, 85vw);
  max-width: 100%;
  background: var(--glass-bg);
  backdrop-filter: blur(var(--blur-lg));
  -webkit-backdrop-filter: blur(var(--blur-lg));
  border-right: 1px solid var(--glass-border);
  box-shadow: var(--shadow-xl);
  transform: translateX(-100%);
  transition: transform var(--transition-slow);
  display: flex;
  flex-direction: column;
}

.left-toggle-menu__panel--open {
  transform: translateX(0);
}

.left-toggle-menu__panel-inner {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 0;
}

.left-toggle-menu__panel-header {
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-3);
  padding: var(--space-5) var(--space-5) var(--space-4);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.left-toggle-menu__panel-title {
  margin: 0;
  font-size: var(--text-lg);
  font-weight: var(--font-semibold);
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.left-toggle-menu__panel-title-icon {
  font-size: var(--text-xl);
  line-height: 1;
}

.left-toggle-menu__panel-close {
  flex-shrink: 0;
  width: 36px;
  height: 36px;
  padding: 0;
  border: none;
  border-radius: var(--radius);
  background: transparent;
  color: var(--tg-theme-hint-color);
  font-size: 1.5rem;
  line-height: 1;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all var(--transition-base);
}

.left-toggle-menu__panel-close:hover,
.left-toggle-menu__panel-close:focus-visible {
  background: rgba(255, 255, 255, 0.1);
  color: var(--tg-theme-text-color);
  transform: scale(var(--hover-scale));
}

.left-toggle-menu__panel-close:active {
  transform: scale(var(--active-scale));
}

.left-toggle-menu__panel-body {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  padding: var(--space-5);
}

.left-toggle-menu__panel-placeholder {
  margin: 0;
  font-size: var(--text-base);
  color: var(--tg-theme-hint-color);
}

.app__body {
  flex: 1;
  min-width: 0;
  min-height: 0;
  display: flex;
  flex-direction: column;
  max-width: 420px;
  margin: 0 auto;
  overflow: hidden;
}

/* –†–µ–∂–∏–º –ø–æ—Å–∞–¥–∫–∏: –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Å–µ–º–µ–Ω–∏ –Ω–∞ —Å–∫–ª–∞–¥–µ –ø–æ–ª–µ –≤—ã–¥–µ–ª–µ–Ω–æ, –æ—Å—Ç–∞–ª—å–Ω–æ–µ –∑–∞—Ç–µ–º–Ω–µ–Ω–æ */
.app--planting-mode .app__left,
.app--planting-mode .app__top,
.app--planting-mode .app__right,
.app--planting-mode .market-wrap,
.app--planting-mode .expand-bar,
.app--planting-mode .field-machinery-bar,
.app--planting-mode .app__bottom {
  opacity: 0.45;
  pointer-events: none;
  transition: opacity 0.2s ease;
}

.app__body-farm-wrap {
  position: relative;
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 0;
  overflow: hidden;
}

.app__planting-zone {
  position: relative;
  z-index: 10;
}

.app--planting-mode .app__planting-zone {
  border-radius: var(--radius-lg);
  box-shadow:
    0 0 0 3px var(--tg-theme-button-color),
    var(--shadow-glow-strong);
  transition: box-shadow var(--transition-base);
  animation: planting-zone-pulse 2s ease-in-out infinite;
}

@keyframes planting-zone-pulse {
  0%,
  100% {
    box-shadow:
      0 0 0 3px var(--tg-theme-button-color),
      var(--shadow-glow-strong);
  }
  50% {
    box-shadow:
      0 0 0 3px var(--tg-theme-button-color),
      var(--shadow-glow);
  }
}

.farm-back-btn {
  display: block;
  width: 100%;
  max-width: 200px;
  margin: var(--space-4) auto var(--space-8);
  padding: var(--space-4) var(--space-6);
  border: none;
  border-radius: var(--radius);
  background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%);
  color: #fff;
  font-size: var(--text-md);
  font-weight: var(--font-semibold);
  cursor: pointer;
  transition: all var(--transition-base);
  box-shadow: var(--shadow-md);
}

.farm-back-btn:hover {
  transform: scale(var(--hover-scale));
  box-shadow: var(--shadow-lg);
}

.farm-back-btn:active {
  transform: scale(var(--active-scale));
}

/* –£–∑–∫–∏–π –±–∞—Ä —Ç–µ—Ö–Ω–∏–∫–∏ –Ω–∞ –ø–æ–ª–µ ‚Äî –≤–æ –≤—Å—é —à–∏—Ä–∏–Ω—É –∫–∞–∫ –∫–Ω–æ–ø–∫–∞ ¬´–†–∞—Å—à–∏—Ä–∏—Ç—å —Ñ–µ—Ä–º—É¬ª */
.field-machinery-bar {
  flex-shrink: 0;
  display: flex;
  align-items: center;
  gap: var(--space-2);
  min-height: 36px;
  margin-left: calc(-1 * var(--space-5));
  width: calc(100% + var(--space-5));
  padding: var(--space-2) max(var(--space-5), env(safe-area-inset-right))
    var(--space-2) max(var(--space-5), env(safe-area-inset-left));
  box-sizing: border-box;
  background: var(--tg-theme-bg-color);
  border: none;
  border-top: 1px solid var(--glass-border);
  font-size: var(--text-sm);
  color: var(--tg-theme-text-color);
}

.field-machinery-bar__label {
  flex-shrink: 0;
  color: var(--tg-theme-hint-color);
  font-weight: var(--font-medium);
}

.field-machinery-bar__list {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: var(--space-2);
  min-width: 0;
}

.field-machinery-bar__item {
  display: flex;
  align-items: center;
  gap: var(--space-1);
  padding: 2px var(--space-2);
  border-radius: var(--radius);
  background: var(--glass-bg-light);
  border: 1px solid var(--glass-border);
}

.field-machinery-bar__emoji {
  font-size: 1rem;
  line-height: 1;
}

.field-machinery-bar__name {
  font-weight: var(--font-medium);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 80px;
}

.field-machinery-bar__count {
  color: var(--tg-theme-hint-color);
  font-size: 0.85em;
}

.field-machinery-bar__params {
  font-size: 0.7rem;
  color: var(--tg-theme-hint-color);
  white-space: nowrap;
}

.field-machinery-bar__return {
  padding: 2px var(--space-2);
  border: none;
  border-radius: var(--radius);
  background: var(--tg-theme-button-color);
  color: var(--tg-theme-button-text-color);
  font-size: 0.75rem;
  font-weight: var(--font-medium);
  cursor: pointer;
  transition: transform 0.1s;
}

.field-machinery-bar__return:active {
  transform: scale(var(--active-scale));
}

/* –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –≤–∏–¥ —Ç–µ—Ö–Ω–∏–∫–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º */
@media (max-width: 520px) {
  .field-machinery-bar {
    flex-wrap: wrap;
    gap: var(--space-1);
    min-height: 0;
    padding: var(--space-1) max(var(--space-3), env(safe-area-inset-right))
      var(--space-1) max(var(--space-3), env(safe-area-inset-left));
    font-size: 0.75rem;
  }

  .field-machinery-bar__label {
    width: 100%;
    font-size: 0.7rem;
    margin-bottom: 2px;
  }

  .field-machinery-bar__list {
    flex-wrap: nowrap;
    overflow-x: auto;
    overflow-y: hidden;
    gap: var(--space-1);
    width: 100%;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: thin;
    padding-bottom: 2px;
  }

  .field-machinery-bar__item {
    flex-shrink: 0;
    gap: 4px;
    padding: 4px 6px;
  }

  .field-machinery-bar__emoji {
    font-size: 0.9rem;
  }

  .field-machinery-bar__name {
    max-width: 52px;
    font-size: 0.7rem;
  }

  .field-machinery-bar__params {
    font-size: 0.65rem;
  }

  .field-machinery-bar__return {
    padding: 2px 6px;
    font-size: 0.65rem;
  }
}

/* –û—Ç–¥–µ–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ë–∏—Ä–∂–∞) */
.app__screen {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 0;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

.app__screen--exchange {
  padding: var(--space-5);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
}

.app__screen--exchange .market {
  margin-top: 0;
  width: 100%;
  max-width: 420px;
}

.app__bottom-hint {
  margin: 0;
  padding: var(--space-4) 0;
  font-size: var(--text-sm);
  color: var(--tg-theme-hint-color);
  text-align: center;
}

.profile-panel__text {
  margin: 0;
  font-size: var(--text-base);
  color: var(--tg-theme-hint-color);
  line-height: 1.5;
}

.app__bottom {
  flex-shrink: 0;
  width: 100%;
  height: 25vh;
  height: 25dvh;
  min-height: 100px;
  display: flex;
  flex-direction: column;
  background: var(--glass-bg);
  backdrop-filter: blur(var(--blur-lg));
  -webkit-backdrop-filter: blur(var(--blur-lg));
  border-top: 1px solid var(--glass-border);
  border-radius: 0 0 var(--radius-lg) var(--radius-lg);
  overflow: hidden;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
  transition: height var(--transition-base);
}

.app__bottom--garage-open {
  height: 42.857vh; /* 3/7 –æ—Ç –≤—ã—Å–æ—Ç—ã —ç–∫—Ä–∞–Ω–∞ */
  height: 42.857dvh;
  min-height: 200px;
}

.app__bottom-scroll {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  padding: var(--space-5) var(--space-5) 0;
  padding-right: max(var(--space-5), env(safe-area-inset-right));
  /* –°–∫—Ä—ã—Ç—å –ø–æ–ª–æ—Å—É –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ */
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* IE –∏ Edge */
}

.app__bottom-scroll::-webkit-scrollbar {
  display: none; /* Chrome, Safari, Opera */
}

/* –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å (–º–µ–Ω—é) ‚Äî –ø–æ —Ü–µ–Ω—Ç—Ä—É –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º */
@media (max-width: 520px) {
  .app__bottom-scroll {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-left: max(var(--space-3), env(safe-area-inset-left));
  }

  .app__bottom-scroll > * {
    width: 100%;
    max-width: 420px;
    margin-left: auto;
    margin-right: auto;
  }

  .exchange-bottom-panel {
    max-width: 420px;
    margin: 0 auto;
  }

  .exchange-bottom-panel__tabs {
    padding-bottom: var(--space-2);
    margin-bottom: var(--space-2);
  }

  .exchange-bottom-panel__tab {
    min-height: 40px;
    padding: var(--space-2) var(--space-3);
    font-size: 0.75rem;
  }

  .exchange-bottom-panel__tab-label {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
}

.app__top {
  flex-shrink: 0;
  height: 15vh;
  height: 15dvh;
  min-height: 0;
  padding: var(--space-4) 0 var(--space-6);
  display: flex;
  justify-content: center;
  align-items: center;
}

/* ----- Stats ----- */
.stats {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: var(--space-3);
}

.stats__coins,
.stats__crypto {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--text-lg);
  font-weight: var(--font-bold);
  background: var(--glass-bg);
  backdrop-filter: blur(var(--blur-md));
  -webkit-backdrop-filter: blur(var(--blur-md));
  border: 1px solid var(--glass-border);
  padding: var(--space-3) var(--space-5);
  border-radius: var(--radius);
  box-shadow: var(--shadow-md);
  transition:
    transform var(--transition-fast),
    box-shadow var(--transition-base);
}

.stats__coins:hover,
.stats__crypto:hover {
  transform: scale(var(--hover-scale));
  box-shadow: var(--shadow-lg);
}

.stats__crypto {
  font-size: var(--text-md);
}

.stats__wallet {
  display: flex;
  align-items: center;
}

/* –ö–Ω–æ–ø–∫–∞ TON Connect ‚Äî –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–æ–¥ —Ç–µ–º—É */
.stats__ton-btn {
  min-height: 36px !important;
}

.stats__ton-btn button,
.stats__ton-btn [data-tc-button] {
  min-height: 36px !important;
  padding: 8px 14px !important;
  border-radius: var(--radius) !important;
  font-size: var(--text-sm) !important;
  font-family: inherit !important;
  background: var(--gradient-button) !important;
  color: var(--tg-theme-button-text-color) !important;
  border: none !important;
  box-shadow: var(--shadow-sm) !important;
  transition: all var(--transition-base) !important;
}

.stats__ton-btn button:hover,
.stats__ton-btn [data-tc-button]:hover {
  transform: scale(var(--hover-scale)) !important;
  box-shadow: var(--shadow-md) !important;
}

/* ----- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: —Ü–µ–Ω—ã + –ø—Ä–æ—Ñ–∏–ª—å (–∫–∞–∫ —Ü–µ–Ω—ã, —Å–ø—Ä–∞–≤–∞) ----- */
.app__right {
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  margin-right: var(--space-3);
  padding-right: 0;
  padding-top: 10px;
}

/* ----- Market (—Ü–µ–Ω—ã): –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–µ–µ, —Ç–µ–∫—Å—Ç –ø–æ —Ü–µ–Ω—Ç—Ä—É ----- */
.market-wrap {
  flex-shrink: 0;
  width: 52px;
  min-width: 52px;
  position: relative;
  padding-top: 0;
}

.market-wrap__panel {
  position: absolute;
  right: 100%;
  top: 0;
  z-index: 10;
  padding-right: 8px;
}

.market-wrap__panel .market {
  border-radius: var(--radius) 0 0 var(--radius);
}

.market-wrap__toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  padding: var(--space-3) var(--space-2);
  min-width: 44px;
  min-height: 44px;
  border: 1px solid rgba(255, 255, 255, 0.25);
  border-radius: var(--radius);
  background: rgba(0, 0, 0, 0.35);
  backdrop-filter: blur(var(--blur-md));
  -webkit-backdrop-filter: blur(var(--blur-md));
  color: var(--tg-theme-text-color);
  font-size: var(--text-sm);
  font-weight: var(--font-semibold);
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  transition: all var(--transition-base);
  box-sizing: border-box;
}

.market-wrap__toggle:hover {
  background: rgba(0, 0, 0, 0.45);
  border-color: rgba(255, 255, 255, 0.35);
  transform: scale(var(--hover-scale));
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.4);
}

.market-wrap__toggle:active {
  transform: scale(var(--active-scale));
}

.market-wrap__toggle-text {
  display: inline-block;
  white-space: nowrap;
  text-align: center;
}

.market {
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(var(--blur-md));
  -webkit-backdrop-filter: blur(var(--blur-md));
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: var(--radius) 0 0 var(--radius);
  padding: var(--space-3) var(--space-5) var(--space-3) var(--space-4);
  min-width: 98px;
  box-sizing: border-box;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.35);
}

.market .market__title,
.market .market__heading {
  color: rgba(255, 255, 255, 0.85);
}

.market .market__row {
  color: var(--tg-theme-text-color);
}

.market .market__price {
  color: var(--tg-theme-text-color);
  font-weight: var(--font-bold);
}

/* ----- Profile wrap (–∫–∞–∫ —Ü–µ–Ω—ã, —Å–ø—Ä–∞–≤–∞) ----- */
.profile-wrap {
  flex-shrink: 0;
  width: 52px;
  min-width: 52px;
  position: relative;
}

.profile-wrap__panel {
  position: absolute;
  right: 100%;
  top: 0;
  z-index: 10;
  padding-right: 8px;
}

.profile-wrap__panel .profile-panel {
  border-radius: var(--radius) 0 0 var(--radius);
  min-width: 200px;
}

.profile-wrap__toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  padding: var(--space-3) var(--space-2);
  min-width: 44px;
  min-height: 44px;
  border: 1px solid rgba(255, 255, 255, 0.25);
  border-radius: var(--radius);
  background: rgba(0, 0, 0, 0.35);
  backdrop-filter: blur(var(--blur-md));
  -webkit-backdrop-filter: blur(var(--blur-md));
  color: var(--tg-theme-text-color);
  font-size: var(--text-sm);
  font-weight: var(--font-semibold);
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  transition: all var(--transition-base);
  box-sizing: border-box;
}

.profile-wrap__toggle:hover {
  background: rgba(0, 0, 0, 0.45);
  border-color: rgba(255, 255, 255, 0.35);
  transform: scale(var(--hover-scale));
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.4);
}

.profile-wrap__toggle:active {
  transform: scale(var(--active-scale));
}

.profile-wrap__toggle-text {
  display: inline-block;
  white-space: nowrap;
  text-align: center;
}

.market__title {
  font-size: var(--text-sm);
  font-weight: var(--font-semibold);
  color: var(--tg-theme-hint-color);
  margin-bottom: var(--space-2);
  text-align: center;
}

.market__section {
  margin-bottom: var(--space-2);
}

.market__section:last-child {
  margin-bottom: 0;
}

.market__heading {
  font-size: var(--text-xs);
  color: var(--tg-theme-hint-color);
  margin-bottom: var(--space-1);
}

.market__row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-2);
  font-size: var(--text-sm);
  padding: 1px 0;
}

.market__emoji {
  font-size: var(--text-md);
  line-height: 1;
}

.market__price {
  font-weight: var(--font-semibold);
  white-space: nowrap;
}

/* ----- Farm grid ----- */
.farm {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-4) var(--space-4) var(--space-5);
  box-sizing: border-box;
}

.farm__grid {
  display: grid;
  gap: var(--farm-gap);
  justify-items: stretch;
  align-items: stretch;
}

.farm__grid .plot {
  width: 100%;
  height: 100%;
  box-sizing: border-box;
}

/* ----- Expand farm bar (full width, above tabs) ----- */
.expand-bar {
  flex-shrink: 0;
  margin-left: calc(-1 * var(--space-5));
  width: calc(100% + var(--space-5));
  padding: var(--space-4) max(var(--space-5), env(safe-area-inset-right))
    var(--space-4) max(var(--space-5), env(safe-area-inset-left));
  box-sizing: border-box;
  background: var(--tg-theme-bg-color);
}

.expand-bar__btn {
  display: block;
  width: 100%;
  padding: var(--space-5) var(--space-6);
  border: none;
  border-radius: var(--radius);
  background: var(--gradient-button);
  color: var(--tg-theme-button-text-color);
  font-size: var(--text-md);
  font-weight: var(--font-semibold);
  cursor: pointer;
  box-shadow: var(--shadow-md);
  transition: all var(--transition-base);
}

.expand-bar__btn:hover:not(:disabled) {
  background: var(--gradient-button-hover);
  transform: scale(var(--hover-scale));
  box-shadow: var(--shadow-lg);
}

.expand-bar__btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.expand-bar__btn:not(:disabled):active {
  transform: scale(var(--active-scale));
}

/* ----- Plot ----- */
.plot {
  border: none;
  border-radius: var(--radius);
  background: var(--glass-bg-light);
  backdrop-filter: blur(var(--blur-sm));
  -webkit-backdrop-filter: blur(var(--blur-sm));
  border: 1px solid var(--glass-border);
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
  transition: all var(--transition-base);
  box-shadow: var(--shadow-sm);
  /* –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ–º —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ */
  text-align: center;
  /* –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è */
  min-width: 0;
  min-height: 0;
}

.plot:hover {
  transform: scale(var(--hover-scale));
  box-shadow: var(--shadow-md);
}

.plot:active {
  transform: scale(var(--active-scale));
}

/* –¶–≤–µ—Ç–∞ –ø–æ —Å—Ç–∞—Ç—É—Å—É —É—á–∞—Å—Ç–∫–∞ */
.plot--empty {
  cursor: pointer;
  border: 2px dashed rgba(255, 255, 255, 0.3);
  background: linear-gradient(135deg, rgba(80, 70, 60, 0.35), rgba(60, 55, 50, 0.4));
}

.plot--empty:hover {
  border-color: rgba(255, 255, 255, 0.5);
  box-shadow: var(--shadow-md);
  background: linear-gradient(135deg, rgba(90, 80, 70, 0.4), rgba(70, 65, 60, 0.45));
}

.plot--empty:active {
  transform: scale(var(--active-scale));
}

.plot__placeholder {
  font-size: var(--text-3xl);
  color: var(--tg-theme-hint-color);
  line-height: 1;
  display: block;
  margin: 0;
  padding: 0;
  /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ flex —Ä–æ–¥–∏—Ç–µ–ª—è */
  flex-shrink: 0;
}

.plot--growing,
.plot--ready {
  cursor: pointer;
}

/* –†–∞—Å—Ç—ë—Ç, –≤—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ */
.plot--growing {
  background: linear-gradient(135deg, rgba(60, 100, 65, 0.4), rgba(45, 85, 55, 0.45));
}

.plot--ready {
  background: linear-gradient(135deg, rgba(200, 165, 60, 0.5), rgba(180, 140, 50, 0.55));
  box-shadow:
    0 0 0 3px var(--tg-theme-button-color),
    var(--shadow-glow);
  animation: plot-ready-pulse 2s ease-in-out infinite;
}

@keyframes plot-ready-pulse {
  0%,
  100% {
    box-shadow:
      0 0 0 3px var(--tg-theme-button-color),
      var(--shadow-glow);
  }
  50% {
    box-shadow:
      0 0 0 3px var(--tg-theme-button-color),
      var(--shadow-glow-strong);
  }
}

/* –ò–¥—ë—Ç —Å–±–æ—Ä —É—Ä–æ–∂–∞—è */
.plot--collecting {
  cursor: default;
  background: linear-gradient(135deg, rgba(220, 140, 50, 0.5), rgba(200, 120, 40, 0.55));
}

.plot--collecting:disabled {
  opacity: 1;
}

.plot__progress--collecting {
  background: rgba(255, 255, 255, 0.25);
}

.plot__emoji {
  font-size: 2.2rem;
  position: relative;
  z-index: 1;
  filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
  line-height: 1;
  display: block;
  margin: 0;
  padding: 0;
  /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ flex —Ä–æ–¥–∏—Ç–µ–ª—è */
  flex-shrink: 0;
}

.plot__progress {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 0 0 var(--radius) var(--radius);
}

.plot__progress::after {
  content: "";
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: calc(var(--progress, 0) * 100%);
  background: var(--gradient-button);
  border-radius: 0 0 0 var(--radius);
  transition: width var(--transition-slow);
  box-shadow: 0 0 8px rgba(74, 124, 89, 0.5);
}

.plot__timer {
  position: absolute;
  bottom: var(--space-2);
  left: 0;
  right: 0;
  font-size: var(--text-xs);
  font-weight: var(--font-normal);
  color: var(--tg-theme-hint-color);
  z-index: 1;
}

.plot__label {
  position: absolute;
  bottom: var(--space-1);
  left: 0;
  right: 0;
  font-size: var(--text-xs);
  font-weight: var(--font-normal);
  color: var(--tg-theme-button-text-color);
  z-index: 1;
}

/* –ù—É–∂–Ω–æ —É–¥–æ–±—Ä–µ–Ω–∏–µ (–±–µ–∑ —Å–æ—Ä–Ω—è–∫–æ–≤) */
.plot--need-fertilize {
  background: linear-gradient(135deg, rgba(90, 110, 70, 0.5), rgba(70, 90, 60, 0.55));
}

/* –ù—É–∂–µ–Ω –ø–æ–ª–∏–≤ */
.plot--need-water {
  background: linear-gradient(135deg, rgba(70, 130, 180, 0.4), rgba(50, 110, 160, 0.45));
  box-shadow: inset 0 0 0 2px rgba(60, 120, 180, 0.35);
}

/* –ù—É–∂–Ω–∞ –ø—Ä–æ–ø–æ–ª–∫–∞ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ –ø–æ–ª–∏–≤–æ–º/—É–¥–æ–±—Ä–µ–Ω–∏–µ–º) */
.plot--weeds {
  background: linear-gradient(135deg, rgba(140, 110, 60, 0.5), rgba(120, 90, 50, 0.55));
  box-shadow: inset 0 0 0 2px rgba(180, 120, 60, 0.4);
}
.plot--weeds::before {
  content: "";
  position: absolute;
  inset: 0;
  background: radial-gradient(ellipse 60% 50% at 50% 30%, rgba(100, 80, 40, 0.2), transparent);
  pointer-events: none;
  border-radius: inherit;
}

.plot__actions {
  position: absolute;
  bottom: var(--space-1);
  left: 0;
  right: 0;
  z-index: 2;
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-1);
  justify-content: center;
  align-items: center;
  padding: 0 var(--space-1);
}

.plot__action {
  padding: var(--space-1) var(--space-2);
  border: none;
  border-radius: var(--radius);
  font-size: 10px;
  font-weight: var(--font-medium);
  cursor: pointer;
  line-height: 1.2;
  white-space: nowrap;
  transition: transform var(--transition-base), box-shadow var(--transition-base);
  flex-shrink: 0;
}
.plot__action:hover {
  transform: scale(1.05);
}
.plot__action:active {
  transform: scale(0.98);
}
.plot__action--weed {
  background: rgba(120, 90, 50, 0.7);
  color: #f5e6c8;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}
.plot__action--weed:hover {
  background: rgba(140, 105, 55, 0.85);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.35);
}
.plot__action--fertilize {
  background: rgba(60, 100, 80, 0.7);
  color: #d4f0e0;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}
.plot__action--fertilize:hover {
  background: rgba(70, 120, 95, 0.85);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.35);
}

.plot__action--water {
  background: rgba(60, 120, 180, 0.6);
  color: #d4e8ff;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}
.plot__action--water:hover {
  background: rgba(70, 140, 200, 0.75);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.35);
}


/* ----- Tabs ----- */
.tabs {
  flex-shrink: 0;
  display: flex;
  gap: calc(var(--space-1) * 1.1);
  padding: calc(var(--space-4) * 1.1) var(--space-5) calc(var(--space-3) * 1.1);
  padding-right: max(var(--space-5), env(safe-area-inset-right));
  padding-bottom: max(calc(var(--space-3) * 1.1), env(safe-area-inset-bottom));
  border-top: 1px solid var(--glass-border);
  border-bottom: none;
  position: relative;
}

.tabs__btn {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: calc(var(--space-1) * 1.1);
  padding: calc(var(--space-3) * 1.1) calc(var(--space-1) * 1.1);
  border: none;
  border-radius: var(--radius);
  background: transparent;
  color: var(--tg-theme-hint-color);
  font-size: calc(var(--text-sm) * 1.1);
  font-weight: var(--font-normal);
  cursor: pointer;
  transition: all var(--transition-base);
  position: relative;
}

.tabs__btn::after {
  content: "";
  position: absolute;
  top: -1px;
  left: 50%;
  transform: translateX(-50%) scaleX(0);
  width: 60%;
  height: 2px;
  background: var(--tg-theme-button-color);
  border-radius: 0 0 2px 2px;
  transition: transform var(--transition-base);
}

.tabs__btn:hover {
  color: var(--tg-theme-text-color);
  transform: translateY(2px);
}

.tabs__btn--active {
  background: var(--glass-bg);
  backdrop-filter: blur(var(--blur-sm));
  -webkit-backdrop-filter: blur(var(--blur-sm));
  color: var(--tg-theme-text-color);
  font-weight: var(--font-semibold);
}

.tabs__btn--active::after {
  transform: translateX(-50%) scaleX(1);
}

.tabs__icon {
  font-size: calc(var(--text-xl) * 1.1);
  line-height: 1;
}

/* –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é ‚Äî —Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞: —á—ë—Ç—á–µ –∫–Ω–æ–ø–∫–∏ */
[data-theme="light"] .tabs__btn {
  color: #444;
  border: 1px solid rgba(0, 0, 0, 0.08);
  background: rgba(255, 255, 255, 0.6);
}

[data-theme="light"] .tabs__btn:hover {
  color: #1a1a2e;
  background: rgba(255, 255, 255, 0.9);
  border-color: rgba(0, 0, 0, 0.12);
}

[data-theme="light"] .tabs__btn--active {
  background: #fff;
  color: #1a1a2e;
  border-color: rgba(74, 124, 89, 0.4);
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
}

[data-theme="light"] .tabs__btn--active::after {
  background: var(--tg-theme-button-color);
  height: 3px;
}

[data-theme="light"] .tabs {
  border-bottom-color: rgba(0, 0, 0, 0.1);
}

/* ----- Panel (Shop / Warehouse / Barn) ----- */
.panel {
  flex-shrink: 0;
  background: var(--glass-bg);
  backdrop-filter: blur(var(--blur-md));
  -webkit-backdrop-filter: blur(var(--blur-md));
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  padding: var(--space-5);
  margin-top: var(--space-3);
  box-shadow: var(--shadow-md);
  transition:
    transform var(--transition-fast),
    box-shadow var(--transition-base);
}

.panel:hover {
  box-shadow: var(--shadow-lg);
}

.panel__title {
  margin: 0 0 var(--space-1);
  font-size: var(--text-md);
  font-weight: var(--font-semibold);
  letter-spacing: var(--letter-spacing-tight);
}

.panel__sub {
  margin: 0 0 var(--space-5);
  font-size: var(--text-sm);
  color: var(--tg-theme-hint-color);
}

.panel__hint-row {
  margin: var(--space-4) 0 0;
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
  align-items: center;
}

.panel__hint {
  margin: 0;
  font-size: var(--text-sm);
  color: var(--tg-theme-hint-color);
  text-align: center;
}

.panel__cancel {
  padding: var(--space-2) var(--space-6);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  background: transparent;
  color: var(--tg-theme-hint-color);
  font-size: var(--text-base);
  font-weight: var(--font-normal);
  cursor: pointer;
  transition: all var(--transition-base);
}

.panel__cancel:hover {
  border-color: var(--tg-theme-text-color);
  color: var(--tg-theme-text-color);
  transform: scale(var(--hover-scale));
}

.panel__cancel:active {
  transform: scale(var(--active-scale));
}

/* ----- Shop ----- */
.shop__block {
  margin-bottom: var(--space-6);
}
.shop__block:last-child {
  margin-bottom: 0;
}
.shop__block-title {
  margin: 0 0 var(--space-3);
  font-size: var(--text-sm);
  font-weight: var(--font-semibold);
  color: var(--tg-theme-hint-color);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}
.shop__seeds {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-3);
}

.shop__seed {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-1);
  padding: var(--space-4) var(--space-6);
  border-radius: var(--radius);
  border: 1px solid var(--glass-border);
  background: var(--glass-bg-light);
  backdrop-filter: blur(var(--blur-sm));
  -webkit-backdrop-filter: blur(var(--blur-sm));
  color: var(--tg-theme-text-color);
  font-size: var(--text-base);
  transition: all var(--transition-base);
  box-shadow: var(--shadow-sm);
}

.shop__seed:hover:not(:disabled) {
  border-color: var(--tg-theme-button-color);
  transform: scale(var(--hover-scale));
  box-shadow: var(--shadow-md);
  background: var(--gradient-accent);
}

.shop__seed:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.shop__seed:not(:disabled):active {
  transform: scale(var(--active-scale));
}

.shop__seed-emoji {
  font-size: var(--text-2xl);
  line-height: 1;
}

.shop__seed-name {
  font-weight: var(--font-medium);
}

.shop__seed-price {
  font-size: var(--text-sm);
  color: var(--tg-theme-hint-color);
}

/* ----- Warehouse ----- */
.warehouse__list {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-3);
}

.warehouse__item {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--space-1);
  width: 80px;
  height: 80px;
  aspect-ratio: 1;
  padding: var(--space-2);
  border-radius: var(--radius);
  border: 1px solid var(--glass-border);
  background: var(--glass-bg-light);
  backdrop-filter: blur(var(--blur-sm));
  -webkit-backdrop-filter: blur(var(--blur-sm));
  color: var(--tg-theme-text-color);
  font-size: var(--text-base);
  transition: all var(--transition-base);
  cursor: pointer;
  box-shadow: var(--shadow-sm);
  box-sizing: border-box;
}

.warehouse__item:hover:not(.warehouse__item--empty) {
  border-color: var(--tg-theme-button-color);
  transform: scale(var(--hover-scale));
  box-shadow: var(--shadow-md);
}

.warehouse__item--empty {
  opacity: 0.5;
  cursor: not-allowed;
}

.warehouse__item--selected {
  border-color: var(--tg-theme-button-color);
  background: var(--gradient-accent);
  box-shadow: var(--shadow-glow);
}

.warehouse__item:not(.warehouse__item--empty):active {
  transform: scale(var(--active-scale));
}

.warehouse__emoji {
  font-size: var(--text-xl);
  line-height: 1;
  flex-shrink: 0;
}

.warehouse__name {
  font-weight: var(--font-medium);
  font-size: var(--text-xs);
  text-align: center;
  line-height: 1.2;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: 100%;
}

.warehouse__count {
  font-size: var(--text-xs);
  color: var(--tg-theme-hint-color);
  flex-shrink: 0;
}

/* ----- Barn ----- */
.panel.barn {
  display: flex;
  flex-direction: column;
  min-height: 0;
}

.panel.barn.barn--empty {
  flex: 1;
  justify-content: center;
}

.barn__list {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  margin-bottom: var(--space-5);
}

.barn__item {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: var(--space-3);
  padding: var(--space-3) var(--space-4);
  background: var(--glass-bg-light);
  backdrop-filter: blur(var(--blur-sm));
  -webkit-backdrop-filter: blur(var(--blur-sm));
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  font-size: var(--text-base);
  box-shadow: var(--shadow-sm);
  transition: all var(--transition-base);
}

.barn__item:hover {
  box-shadow: var(--shadow-md);
  transform: translateX(2px);
}

.barn__emoji {
  font-size: var(--text-xl);
  line-height: 1;
}

.barn__name {
  flex: 1;
  font-weight: var(--font-medium);
}

.barn__count {
  color: var(--tg-theme-hint-color);
}

.barn__value {
  font-weight: var(--font-semibold);
}

.barn__item-actions {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  margin-left: auto;
  flex-shrink: 0;
}

.barn__qty-stepper {
  display: flex;
  align-items: center;
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  overflow: hidden;
  background: var(--glass-bg);
  backdrop-filter: blur(var(--blur-sm));
  -webkit-backdrop-filter: blur(var(--blur-sm));
  box-shadow: var(--shadow-xs);
}

.barn__qty-btn {
  width: 32px;
  height: 32px;
  padding: 0;
  border: none;
  background: var(--glass-bg);
  color: var(--tg-theme-text-color);
  font-size: var(--text-lg);
  font-weight: var(--font-semibold);
  line-height: 1;
  cursor: pointer;
  transition: all var(--transition-base);
}

.barn__qty-btn:hover:not(:disabled) {
  background: rgba(255, 255, 255, 0.1);
  transform: scale(var(--hover-scale));
}

.barn__qty-btn:active:not(:disabled) {
  transform: scale(var(--active-scale));
}

.barn__qty-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.barn__qty-value {
  min-width: 2ch;
  padding: 0 var(--space-3);
  font-size: var(--text-base);
  font-weight: var(--font-semibold);
  text-align: center;
  color: var(--tg-theme-text-color);
}

.barn__sell-row {
  padding: var(--space-2) var(--space-4);
  border: none;
  border-radius: var(--radius);
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  background: var(--gradient-button);
  color: var(--tg-theme-button-text-color);
  cursor: pointer;
  transition: all var(--transition-base);
  box-shadow: var(--shadow-sm);
}

.barn__sell-row:hover {
  transform: scale(var(--hover-scale));
  box-shadow: var(--shadow-md);
}

.barn__sell-row:active {
  transform: scale(var(--active-scale));
}

.barn__empty {
  margin: auto 0;
  font-size: var(--text-base);
  color: var(--tg-theme-hint-color);
  text-align: center;
  padding: var(--space-5) 0;
}

.barn__sell {
  width: 100%;
  padding: var(--space-5);
  border: none;
  border-radius: var(--radius);
  background: var(--gradient-button);
  color: var(--tg-theme-button-text-color);
  font-size: var(--text-md);
  font-weight: var(--font-semibold);
  cursor: pointer;
  transition: all var(--transition-base);
  box-shadow: var(--shadow-md);
}

.barn__sell:hover {
  background: var(--gradient-button-hover);
  transform: scale(var(--hover-scale));
  box-shadow: var(--shadow-lg);
}

.barn__sell:active {
  transform: scale(var(--active-scale));
}

/* ----- Garage ----- */
.garage__empty {
  text-align: center;
  padding: 20px 10px;
}

.garage__icon {
  font-size: 2.5rem;
  display: block;
  margin-bottom: var(--space-3);
  opacity: 0.8;
  line-height: 1;
}

.garage__empty p {
  margin: 0;
  font-size: var(--text-base);
  color: var(--tg-theme-hint-color);
}

.garage__filters {
  display: flex;
  flex-direction: column;
  gap: var(--space-4);
  margin-bottom: var(--space-5);
  padding-bottom: var(--space-4);
  border-bottom: 1px solid var(--glass-border);
}

.garage__filter-group {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.garage__filter-label {
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  color: var(--tg-theme-hint-color);
}

.garage__filter-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-2);
}

.garage__filter-btn {
  display: flex;
  align-items: center;
  gap: var(--space-1);
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius);
  border: 1px solid var(--glass-border);
  background: var(--glass-bg-light);
  color: var(--tg-theme-text-color);
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  cursor: pointer;
  transition: all var(--transition-base);
}

.garage__filter-btn:hover {
  border-color: var(--tg-theme-button-color);
  transform: scale(var(--hover-scale));
}

.garage__filter-btn--active {
  background: var(--gradient-accent);
  border-color: var(--tg-theme-button-color);
  color: var(--tg-theme-button-text-color);
}

.garage__filter-count {
  font-size: var(--text-xs);
  opacity: 0.8;
}

.garage__empty-filter {
  text-align: center;
  padding: var(--space-5);
  color: var(--tg-theme-hint-color);
  font-size: var(--text-sm);
}

.garage__list {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
}

.garage__unit {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  gap: var(--space-3);
  padding: var(--space-4);
  border-radius: var(--radius);
  border: 1px solid var(--glass-border);
  background: var(--glass-bg-light);
  backdrop-filter: blur(var(--blur-sm));
  -webkit-backdrop-filter: blur(var(--blur-sm));
  color: var(--tg-theme-text-color);
  font-size: var(--text-base);
  transition: all var(--transition-base);
}

.garage__unit:hover {
  box-shadow: var(--shadow-md);
  transform: translateX(2px);
}

.garage__unit--needs-maintenance {
  border-color: rgba(255, 165, 0, 0.5);
  background: rgba(255, 165, 0, 0.05);
}

.garage__unit-emoji {
  font-size: var(--text-2xl);
  line-height: 1;
  flex-shrink: 0;
}

.garage__unit-info {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
  flex: 1;
  min-width: 0;
}

.garage__unit-name {
  font-weight: var(--font-semibold);
  font-size: var(--text-md);
}

.garage__unit-stats {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.garage__unit-stat {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.garage__unit-stat-label {
  font-size: var(--text-xs);
  color: var(--tg-theme-hint-color);
}

.garage__unit-stat-bar {
  position: relative;
  height: 20px;
  background: rgba(0, 0, 0, 0.2);
  border-radius: var(--radius-sm);
  overflow: hidden;
}

.garage__unit-stat-fill {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  border-radius: var(--radius-sm);
  transition: width var(--transition-base);
}

.garage__unit-stat-fill--fuel {
  background: linear-gradient(90deg, #4a90e2, #357abd);
}

.garage__unit-stat-fill--integrity {
  background: linear-gradient(90deg, #50c878, #3da85a);
}

.garage__unit-stat-value {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: var(--text-xs);
  font-weight: var(--font-semibold);
  color: #fff;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
  z-index: 1;
}

.garage__unit-actions {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  flex-shrink: 0;
}

.garage__item {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-3) var(--space-4);
  border-radius: var(--radius);
  border: 1px solid var(--glass-border);
  background: var(--glass-bg-light);
  backdrop-filter: blur(var(--blur-sm));
  -webkit-backdrop-filter: blur(var(--blur-sm));
  color: var(--tg-theme-text-color);
  font-size: var(--text-base);
  width: 100%;
}

.garage__item-emoji {
  font-size: var(--text-xl);
  line-height: 1;
}

.garage__item-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
  min-width: 0;
}

.garage__item-name {
  font-weight: var(--font-medium);
}

.garage__item-count {
  font-size: var(--text-sm);
  color: var(--tg-theme-hint-color);
}

.garage__item-params {
  font-size: 0.75rem;
  color: var(--tg-theme-hint-color);
}

.garage__item-actions {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-2);
  margin-left: auto;
  align-items: center;
}

.garage__btn {
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius);
  border: 1px solid var(--glass-border);
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  cursor: pointer;
  white-space: nowrap;
  transition: opacity 0.15s, transform 0.1s;
}

.garage__btn:active {
  transform: scale(var(--active-scale));
}

.garage__btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.garage__btn--field {
  background: var(--glass-bg);
  color: var(--tg-theme-button-color);
  border-color: var(--tg-theme-button-color);
}

.garage__btn--maintenance {
  background: rgba(255, 165, 0, 0.2);
  color: #ff8c00;
  border-color: rgba(255, 165, 0, 0.5);
}

.garage__btn--maintenance:hover:not(:disabled) {
  background: rgba(255, 165, 0, 0.3);
  border-color: rgba(255, 165, 0, 0.7);
}

.garage__btn--sell {
  background: var(--glass-bg);
  color: var(--tg-theme-destructive-text-color, #e53935);
  border-color: var(--tg-theme-destructive-text-color, #e53935);
}

/* ----- DevTools ----- */
.devtools__actions {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
}

.devtools__btn {
  width: 100%;
  padding: var(--space-4);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  background: var(--glass-bg);
  backdrop-filter: blur(var(--blur-sm));
  -webkit-backdrop-filter: blur(var(--blur-sm));
  color: var(--tg-theme-text-color);
  font-size: var(--text-base);
  font-weight: var(--font-semibold);
  cursor: pointer;
  transition: all var(--transition-base);
  box-shadow: var(--shadow-sm);
}

.devtools__btn:hover {
  border-color: var(--tg-theme-button-color);
  background: var(--glass-bg-light);
  transform: scale(var(--hover-scale));
  box-shadow: var(--shadow-md);
}

.devtools__btn:active {
  transform: scale(var(--active-scale));
}

.devtools__reset {
  width: 100%;
  padding: var(--space-5);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  background: var(--glass-bg);
  backdrop-filter: blur(var(--blur-sm));
  -webkit-backdrop-filter: blur(var(--blur-sm));
  color: var(--tg-theme-destructive-text-color, #e53935);
  font-size: var(--text-md);
  font-weight: var(--font-semibold);
  cursor: pointer;
  transition: all var(--transition-base);
  box-shadow: var(--shadow-sm);
  margin-top: var(--space-2);
}

.devtools__reset:hover {
  border-color: var(--tg-theme-destructive-text-color, #e53935);
  transform: scale(var(--hover-scale));
  box-shadow: var(--shadow-md);
}

.devtools__reset:active {
  transform: scale(var(--active-scale));
}

/* ----- Tutorial overlay ----- */
.tutorial-overlay {
  position: fixed;
  inset: 0;
  z-index: 100;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-7);
  box-sizing: border-box;
}

.tutorial-overlay__backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

.tutorial-overlay__card {
  position: relative;
  background: var(--glass-bg);
  backdrop-filter: blur(var(--blur-lg));
  -webkit-backdrop-filter: blur(var(--blur-lg));
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-lg);
  padding: var(--space-8);
  max-width: 320px;
  width: 100%;
  box-shadow: var(--shadow-xl);
  animation: tutorial-card-enter var(--transition-slow) ease;
}

@keyframes tutorial-card-enter {
  from {
    opacity: 0;
    transform: scale(0.9) translateY(-20px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.tutorial-overlay__title {
  margin: 0 0 var(--space-6);
  font-size: var(--text-xl);
  font-weight: var(--font-semibold);
  letter-spacing: var(--letter-spacing-tight);
}

.tutorial-overlay__steps {
  margin: 0 0 var(--space-8);
  padding-left: var(--space-8);
  line-height: 1.6;
  font-size: var(--text-base);
  color: var(--tg-theme-text-color);
}

.tutorial-overlay__steps li {
  margin-bottom: var(--space-2);
}

.tutorial-overlay__btn {
  width: 100%;
  padding: var(--space-5);
  border: none;
  border-radius: var(--radius);
  background: var(--gradient-button);
  color: var(--tg-theme-button-text-color);
  font-size: var(--text-md);
  font-weight: var(--font-semibold);
  cursor: pointer;
  transition: all var(--transition-base);
  box-shadow: var(--shadow-md);
}

.tutorial-overlay__btn:hover {
  background: var(--gradient-button-hover);
  transform: scale(var(--hover-scale));
  box-shadow: var(--shadow-lg);
}

.tutorial-overlay__btn:active {
  transform: scale(var(--active-scale));
}
